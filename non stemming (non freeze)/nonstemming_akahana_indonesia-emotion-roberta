{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"testing_nonstemming_akahana/indonesia-emotion-robertaipynb","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyMC8xHaDTbdrnLPlbxAPv6n"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"49e5076bfff94ca9a10552adceb882c8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_bbd3ee567ed844dfa733361b6b43295e","IPY_MODEL_a346078fb6f54a9791e087e30c594828","IPY_MODEL_1c61912894424c9cb0cd39f6d0020b75"],"layout":"IPY_MODEL_dea98e6853a54c8499e0ba06f9b7e995"}},"bbd3ee567ed844dfa733361b6b43295e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f89121ceaa0d40558d2e0851bebd3889","placeholder":"​","style":"IPY_MODEL_de01b3753346448499c5c63484838bd7","value":"Downloading: 100%"}},"a346078fb6f54a9791e087e30c594828":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d252f4cf4a5f4c2484064761ccce4707","max":352,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6ef4ee5f0aa44593bd0a16da452c9e50","value":352}},"1c61912894424c9cb0cd39f6d0020b75":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0b438f2f4b6e43c0bdaa9909b3f5e0f5","placeholder":"​","style":"IPY_MODEL_7a44fa3dc1324f88af28273a769795ac","value":" 352/352 [00:00&lt;00:00, 6.97kB/s]"}},"dea98e6853a54c8499e0ba06f9b7e995":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f89121ceaa0d40558d2e0851bebd3889":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"de01b3753346448499c5c63484838bd7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d252f4cf4a5f4c2484064761ccce4707":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6ef4ee5f0aa44593bd0a16da452c9e50":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0b438f2f4b6e43c0bdaa9909b3f5e0f5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7a44fa3dc1324f88af28273a769795ac":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0a0781d4c4394a608d1d6b524f75dba6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4bdfc265a7ec4e6bbd9fc221db1bd16c","IPY_MODEL_2ceadb5b746f4af587327324b1d76b64","IPY_MODEL_2cb525ced1ab475c9a2e68541db8faab"],"layout":"IPY_MODEL_f6a0c3c081c746359437a8ed5192cd23"}},"4bdfc265a7ec4e6bbd9fc221db1bd16c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1b18d16de4e14e1b8bc6d9200b9b3002","placeholder":"​","style":"IPY_MODEL_2fc8a8080e764bb8939f0cf72d06854e","value":"Downloading: 100%"}},"2ceadb5b746f4af587327324b1d76b64":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2d71e428dcf345739f0d50e4e39e3ae6","max":808408,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ace5197c28054ab186a4964eaf0e21a8","value":808408}},"2cb525ced1ab475c9a2e68541db8faab":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ba3898055aab4039aec5a1995510a0ff","placeholder":"​","style":"IPY_MODEL_6ccd745486e541b7b7b685e9b0d658d5","value":" 789k/789k [00:00&lt;00:00, 1.62MB/s]"}},"f6a0c3c081c746359437a8ed5192cd23":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1b18d16de4e14e1b8bc6d9200b9b3002":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2fc8a8080e764bb8939f0cf72d06854e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2d71e428dcf345739f0d50e4e39e3ae6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ace5197c28054ab186a4964eaf0e21a8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ba3898055aab4039aec5a1995510a0ff":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6ccd745486e541b7b7b685e9b0d658d5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a4a287a10f514fc2858b5298f6b81efd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9a1c5a6d1ad74fd48a3d2896e6a5061f","IPY_MODEL_d8ac1ba319194d40902248f7cd8b57e8","IPY_MODEL_0a1659e3fd28470292329e73df2ee76f"],"layout":"IPY_MODEL_e99fabddc4534defb1d528142c9c8626"}},"9a1c5a6d1ad74fd48a3d2896e6a5061f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_32fc3f3eae4d4eea846479d5550e8c1e","placeholder":"​","style":"IPY_MODEL_47e5382859da4e19aff813f8095ac234","value":"Downloading: 100%"}},"d8ac1ba319194d40902248f7cd8b57e8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_bb58fa691af047688ad614d6c631d58f","max":466712,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8c614aff912b4b6ebc0486a36170cbb6","value":466712}},"0a1659e3fd28470292329e73df2ee76f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_74bc89aa47944b02ae5a6ebe7d1af29e","placeholder":"​","style":"IPY_MODEL_38d92ea5b69e43cda34ada7e227af018","value":" 456k/456k [00:00&lt;00:00, 1.86MB/s]"}},"e99fabddc4534defb1d528142c9c8626":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"32fc3f3eae4d4eea846479d5550e8c1e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"47e5382859da4e19aff813f8095ac234":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bb58fa691af047688ad614d6c631d58f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8c614aff912b4b6ebc0486a36170cbb6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"74bc89aa47944b02ae5a6ebe7d1af29e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"38d92ea5b69e43cda34ada7e227af018":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1545b265d85a416ca1ce3fa174cc4533":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b93730345bd04edc870d23c7b2293e5f","IPY_MODEL_e8e88106787e4f0caad8a03fbfe3994d","IPY_MODEL_e21ced7dd14c4f54b941b51b7125403d"],"layout":"IPY_MODEL_df58806ad6f44ba4ad96fb815695d38f"}},"b93730345bd04edc870d23c7b2293e5f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8802efadf22741fd862210f873833f45","placeholder":"​","style":"IPY_MODEL_f6e69c25fe774d31a89c8043c4bb4c78","value":"Downloading: 100%"}},"e8e88106787e4f0caad8a03fbfe3994d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_05373ead85f14b0b97bb5e499ee84ff4","max":1376141,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d11b77342d3b422282cb3397cfd14c30","value":1376141}},"e21ced7dd14c4f54b941b51b7125403d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bded2321dcdd48578b2e0d7253c9952c","placeholder":"​","style":"IPY_MODEL_f5384b6664e54f429ffec3a454a010a5","value":" 1.31M/1.31M [00:00&lt;00:00, 4.99MB/s]"}},"df58806ad6f44ba4ad96fb815695d38f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8802efadf22741fd862210f873833f45":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f6e69c25fe774d31a89c8043c4bb4c78":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"05373ead85f14b0b97bb5e499ee84ff4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d11b77342d3b422282cb3397cfd14c30":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bded2321dcdd48578b2e0d7253c9952c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f5384b6664e54f429ffec3a454a010a5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c40491c19ff04a54a509ebc260806467":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b13e7fc7d1664972a11469567124a3bc","IPY_MODEL_3b58a700f78b467598ee83f6627098e5","IPY_MODEL_9627ee42412445dd9b61086cf1dbb13c"],"layout":"IPY_MODEL_3ac62c8525834ef4b0b417cbbba2dcd6"}},"b13e7fc7d1664972a11469567124a3bc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_faa49dee82444a7b81c7366b919da760","placeholder":"​","style":"IPY_MODEL_9205e10dcb32439b9411a1e4726d0d2c","value":"Downloading: 100%"}},"3b58a700f78b467598ee83f6627098e5":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_a5e2f752470e40d49539dbd3fe5e87de","max":239,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9e0a00b5cdb94fc399568dc01ef01252","value":239}},"9627ee42412445dd9b61086cf1dbb13c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_19c5f4e5ea674be1a9fd61f700088873","placeholder":"​","style":"IPY_MODEL_3862c2e51c1c4e0dbe6e554fe2614dd8","value":" 239/239 [00:00&lt;00:00, 1.39kB/s]"}},"3ac62c8525834ef4b0b417cbbba2dcd6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"faa49dee82444a7b81c7366b919da760":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9205e10dcb32439b9411a1e4726d0d2c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a5e2f752470e40d49539dbd3fe5e87de":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9e0a00b5cdb94fc399568dc01ef01252":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"19c5f4e5ea674be1a9fd61f700088873":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3862c2e51c1c4e0dbe6e554fe2614dd8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b002b8716fbe4b36b93623df9d64e1b4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0756e71eb1354c428a96c608dd1258ef","IPY_MODEL_e78bffd8531e4d64ba62f693d28ca2fb","IPY_MODEL_9020581a34a342a1aba83913c4ddc476"],"layout":"IPY_MODEL_f19d6ced1e4f4441a1a3c4fc92dc4a7f"}},"0756e71eb1354c428a96c608dd1258ef":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_275a3af047364f539a00d4823ef8863a","placeholder":"​","style":"IPY_MODEL_7802122baed24fc5ae894a2facc2352a","value":"Downloading: 100%"}},"e78bffd8531e4d64ba62f693d28ca2fb":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8633864eff3d40a7a2f06d284f30c94f","max":1010,"min":0,"orientation":"horizontal","style":"IPY_MODEL_aef8d6d3bd184658952d65b90e5cb177","value":1010}},"9020581a34a342a1aba83913c4ddc476":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_176618c770244fca925be080e4161539","placeholder":"​","style":"IPY_MODEL_23dfa750b9d04731b6e7a3f5d0036fbd","value":" 0.99k/0.99k [00:00&lt;00:00, 5.73kB/s]"}},"f19d6ced1e4f4441a1a3c4fc92dc4a7f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"275a3af047364f539a00d4823ef8863a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7802122baed24fc5ae894a2facc2352a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8633864eff3d40a7a2f06d284f30c94f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"aef8d6d3bd184658952d65b90e5cb177":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"176618c770244fca925be080e4161539":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"23dfa750b9d04731b6e7a3f5d0036fbd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"71105c3a43c84d83b60ba4d704efaa71":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d29cf25a07ea4ac7a960909d88fbd12f","IPY_MODEL_094c7a6af2e04eddb7bd2fc944c60445","IPY_MODEL_c069bfc4adb24865a3b4228174365bef"],"layout":"IPY_MODEL_78d45a663b4c4403a2573c84a7ba653c"}},"d29cf25a07ea4ac7a960909d88fbd12f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_db7ad0cd2aeb4443947ead8601a03934","placeholder":"​","style":"IPY_MODEL_000cca25b85545e5bf4939171fccc180","value":"Downloading: 100%"}},"094c7a6af2e04eddb7bd2fc944c60445":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f2e68040eee8459c98c560d35f01c27c","max":498683309,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0130374e41414c7f8e26234aaf1fadfb","value":498683309}},"c069bfc4adb24865a3b4228174365bef":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d0be7b359322483899d2662b26b306a5","placeholder":"​","style":"IPY_MODEL_4b61cd05673e4cbdb5fb1dbdaf7141ae","value":" 476M/476M [00:32&lt;00:00, 33.0MB/s]"}},"78d45a663b4c4403a2573c84a7ba653c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"db7ad0cd2aeb4443947ead8601a03934":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"000cca25b85545e5bf4939171fccc180":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f2e68040eee8459c98c560d35f01c27c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0130374e41414c7f8e26234aaf1fadfb":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d0be7b359322483899d2662b26b306a5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4b61cd05673e4cbdb5fb1dbdaf7141ae":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["!pip install transformers"],"metadata":{"id":"9JZH-j7WzxCS","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1651378667213,"user_tz":-420,"elapsed":17506,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"4b45a007-3d3a-4750-bea2-2d352f3ca0cd"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting transformers\n","  Downloading transformers-4.18.0-py3-none-any.whl (4.0 MB)\n","\u001b[K     |████████████████████████████████| 4.0 MB 5.3 MB/s \n","\u001b[?25hRequirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Collecting pyyaml>=5.1\n","  Downloading PyYAML-6.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (596 kB)\n","\u001b[K     |████████████████████████████████| 596 kB 28.1 MB/s \n","\u001b[?25hCollecting tokenizers!=0.11.3,<0.13,>=0.11.1\n","  Downloading tokenizers-0.12.1-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (6.6 MB)\n","\u001b[K     |████████████████████████████████| 6.6 MB 33.3 MB/s \n","\u001b[?25hRequirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.64.0)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.11.3)\n","Collecting huggingface-hub<1.0,>=0.1.0\n","  Downloading huggingface_hub-0.5.1-py3-none-any.whl (77 kB)\n","\u001b[K     |████████████████████████████████| 77 kB 5.9 MB/s \n","\u001b[?25hCollecting sacremoses\n","  Downloading sacremoses-0.0.49-py3-none-any.whl (895 kB)\n","\u001b[K     |████████████████████████████████| 895 kB 41.7 MB/s \n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.6.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.1.0->transformers) (4.2.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.8)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.8.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2021.10.8)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.1.0)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (7.1.2)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.15.0)\n","Installing collected packages: pyyaml, tokenizers, sacremoses, huggingface-hub, transformers\n","  Attempting uninstall: pyyaml\n","    Found existing installation: PyYAML 3.13\n","    Uninstalling PyYAML-3.13:\n","      Successfully uninstalled PyYAML-3.13\n","Successfully installed huggingface-hub-0.5.1 pyyaml-6.0 sacremoses-0.0.49 tokenizers-0.12.1 transformers-4.18.0\n"]}]},{"cell_type":"code","source":["import pandas as pd\n","df = pd.read_csv('dataset_nonstemming.csv')\n","df.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"DNzbIVS1p5L-","executionInfo":{"status":"ok","timestamp":1651378668480,"user_tz":-420,"elapsed":1285,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"2110ffc0-817f-4a30-ad05-d36d9f8c534e"},"execution_count":2,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   label                                              tweet\n","0  anger  Soal jln Jatibaru,polisi tdk bs GERTAK gubernu...\n","1  anger  Sesama cewe lho (kayaknya), harusnya bisa lebi...\n","2  happy  Kepingin gudeg mbarek Bu hj. Amad Foto dari go...\n","3  anger  Jln Jatibaru,bagian dari wilayah Tn Abang.Peng...\n","4  happy  Sharing pengalaman aja, kemarin jam 18.00 bata..."],"text/html":["\n","  <div id=\"df-85c481b7-2b51-40d0-8b73-581fa03d7a67\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>label</th>\n","      <th>tweet</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>anger</td>\n","      <td>Soal jln Jatibaru,polisi tdk bs GERTAK gubernu...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>anger</td>\n","      <td>Sesama cewe lho (kayaknya), harusnya bisa lebi...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>happy</td>\n","      <td>Kepingin gudeg mbarek Bu hj. Amad Foto dari go...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>anger</td>\n","      <td>Jln Jatibaru,bagian dari wilayah Tn Abang.Peng...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>happy</td>\n","      <td>Sharing pengalaman aja, kemarin jam 18.00 bata...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-85c481b7-2b51-40d0-8b73-581fa03d7a67')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-85c481b7-2b51-40d0-8b73-581fa03d7a67 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-85c481b7-2b51-40d0-8b73-581fa03d7a67');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":2}]},{"cell_type":"code","source":["import torch\n","import numpy as np\n","\n","# If there's a GPU available...\n","if torch.cuda.is_available():    \n","\n","    # Tell PyTorch to use the GPU.    \n","    device = torch.device(\"cuda\")\n","\n","    print('There are %d GPU(s) available.' % torch.cuda.device_count())\n","\n","    print('We will use the GPU:', torch.cuda.get_device_name(0))\n","\n","# If not...\n","else:\n","    print('No GPU available, using the CPU instead.')\n","    device = torch.device(\"cpu\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"WaI6AfHMpjhn","executionInfo":{"status":"ok","timestamp":1651378671239,"user_tz":-420,"elapsed":2769,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"c5e8fbd4-5bb2-48e9-9e1c-ea0af12468fa"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["There are 1 GPU(s) available.\n","We will use the GPU: Tesla K80\n"]}]},{"cell_type":"code","source":["df.loc[df['label'] == 'anger', 'labels'] = 1\n","df.loc[df['label'] =='happy', 'labels'] = 4\n","df.loc[df['label'] == 'sadness', 'labels'] = 0\n","df.loc[df['label'] =='fear', 'labels'] = 3\n","df.loc[df['label'] == 'love', 'labels'] = 2"],"metadata":{"id":"msHAf6J0u6ze","executionInfo":{"status":"ok","timestamp":1651378671240,"user_tz":-420,"elapsed":39,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["del df['label']\n","df.head(5)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"XXxyONCHud1g","executionInfo":{"status":"ok","timestamp":1651378671241,"user_tz":-420,"elapsed":38,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"df05ebd4-9129-4c52-d31b-8364a0c9fb35"},"execution_count":5,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                               tweet  labels\n","0  Soal jln Jatibaru,polisi tdk bs GERTAK gubernu...     1.0\n","1  Sesama cewe lho (kayaknya), harusnya bisa lebi...     1.0\n","2  Kepingin gudeg mbarek Bu hj. Amad Foto dari go...     4.0\n","3  Jln Jatibaru,bagian dari wilayah Tn Abang.Peng...     1.0\n","4  Sharing pengalaman aja, kemarin jam 18.00 bata...     4.0"],"text/html":["\n","  <div id=\"df-3e69e677-8a7a-4e57-a449-aeb65152546e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>tweet</th>\n","      <th>labels</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Soal jln Jatibaru,polisi tdk bs GERTAK gubernu...</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Sesama cewe lho (kayaknya), harusnya bisa lebi...</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Kepingin gudeg mbarek Bu hj. Amad Foto dari go...</td>\n","      <td>4.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Jln Jatibaru,bagian dari wilayah Tn Abang.Peng...</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Sharing pengalaman aja, kemarin jam 18.00 bata...</td>\n","      <td>4.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-3e69e677-8a7a-4e57-a449-aeb65152546e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-3e69e677-8a7a-4e57-a449-aeb65152546e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-3e69e677-8a7a-4e57-a449-aeb65152546e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":5}]},{"cell_type":"code","source":[" df = df.rename(columns={\"labels\": \"tagging\"})"],"metadata":{"id":"raXmUsOpv5Wn","executionInfo":{"status":"ok","timestamp":1651378671242,"user_tz":-420,"elapsed":36,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":6,"outputs":[]},{"cell_type":"code","source":["df.head(5)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"mkR85GorwbVI","executionInfo":{"status":"ok","timestamp":1651378671243,"user_tz":-420,"elapsed":36,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"0e13f84f-75ff-4426-b4e2-7e57fde71b8a"},"execution_count":7,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                               tweet  tagging\n","0  Soal jln Jatibaru,polisi tdk bs GERTAK gubernu...      1.0\n","1  Sesama cewe lho (kayaknya), harusnya bisa lebi...      1.0\n","2  Kepingin gudeg mbarek Bu hj. Amad Foto dari go...      4.0\n","3  Jln Jatibaru,bagian dari wilayah Tn Abang.Peng...      1.0\n","4  Sharing pengalaman aja, kemarin jam 18.00 bata...      4.0"],"text/html":["\n","  <div id=\"df-f13868ae-e0b7-4a3b-ad0f-2a94352c0f92\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>tweet</th>\n","      <th>tagging</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Soal jln Jatibaru,polisi tdk bs GERTAK gubernu...</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Sesama cewe lho (kayaknya), harusnya bisa lebi...</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Kepingin gudeg mbarek Bu hj. Amad Foto dari go...</td>\n","      <td>4.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Jln Jatibaru,bagian dari wilayah Tn Abang.Peng...</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Sharing pengalaman aja, kemarin jam 18.00 bata...</td>\n","      <td>4.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f13868ae-e0b7-4a3b-ad0f-2a94352c0f92')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-f13868ae-e0b7-4a3b-ad0f-2a94352c0f92 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-f13868ae-e0b7-4a3b-ad0f-2a94352c0f92');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":7}]},{"cell_type":"code","source":["df.tweet[2]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"cuBW6N-NqEua","executionInfo":{"status":"ok","timestamp":1651378671244,"user_tz":-420,"elapsed":34,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"236c59cd-d3b0-4147-806f-6c8d4add8f9f"},"execution_count":8,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'Kepingin gudeg mbarek Bu hj. Amad Foto dari google, sengaja, biar teman-teman jg membayangkannya. Berbagi itu indah.'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["df.tagging.value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GKv3FfGuqJ8d","executionInfo":{"status":"ok","timestamp":1651378671245,"user_tz":-420,"elapsed":33,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"91dde3fc-d423-4beb-f4db-22806646cd69"},"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1.0    1101\n","4.0    1017\n","0.0     997\n","3.0     649\n","2.0     637\n","Name: tagging, dtype: int64"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["tweet = df.tweet.values\n","labels = df.tagging.values"],"metadata":{"id":"c8UFJP2KqPm6","executionInfo":{"status":"ok","timestamp":1651378671246,"user_tz":-420,"elapsed":28,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":10,"outputs":[]},{"cell_type":"code","source":["import re\n","\n","def preprocess_text(sentence):\n","    # Remove punctuations and numbers\n","    sentence = re.sub('[^a-zA-Z]', ' ', sentence)\n","\n","    # Single character removal\n","    sentence = re.sub(r\"\\s+[a-zA-Z]\\s+\", ' ', sentence)\n","\n","    # Removing multiple spaces\n","    sentence = re.sub(r'\\s+', ' ', sentence)\n","\n","    return sentence.lower()"],"metadata":{"id":"49QR4MbyqVdG","executionInfo":{"status":"ok","timestamp":1651378671248,"user_tz":-420,"elapsed":29,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","source":["tweet_short = []\n","\n","for index,sentences in enumerate(tweet):\n","  sentences = preprocess_text(sentences)\n","  temp_word = sentences.split()\n","\n","  length = len(temp_word)\n","\n","  if(length > 280):\n","    temp_word = temp_word[:280]\n","\n","  tweet_short.append(temp_word)"],"metadata":{"id":"8cW26yEMqZuy","executionInfo":{"status":"ok","timestamp":1651378671249,"user_tz":-420,"elapsed":29,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":12,"outputs":[]},{"cell_type":"code","source":["tweet_short[0][len(tweet_short[0]) - 20:len(tweet_short[0])]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cv8e6YOAqkv5","executionInfo":{"status":"ok","timestamp":1651378671250,"user_tz":-420,"elapsed":30,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"64ae2418-d23c-434c-93d8-cc3f0cab761f"},"execution_count":13,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['ikut',\n"," 'pmbhasan',\n"," 'jgn',\n"," 'berpolitik',\n"," 'pengaturan',\n"," 'wilayah',\n"," 'hak',\n"," 'gubernur',\n"," 'persoalan',\n"," 'tn',\n"," 'abang',\n"," 'soal',\n"," 'turun',\n"," 'temurun',\n"," 'pelik',\n"," 'perlu',\n"," 'kesabaran',\n"," 'username',\n"," 'username',\n"," 'url']"]},"metadata":{},"execution_count":13}]},{"cell_type":"code","source":["len(tweet_short[0])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-Hlfy7nsqvYW","executionInfo":{"status":"ok","timestamp":1651378671731,"user_tz":-420,"elapsed":8,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"9ca5e470-1c0a-4c71-de3e-94a3748d278d"},"execution_count":14,"outputs":[{"output_type":"execute_result","data":{"text/plain":["31"]},"metadata":{},"execution_count":14}]},{"cell_type":"code","source":["from transformers import BertTokenizer, BertConfig,AdamW, BertForSequenceClassification,get_linear_schedule_with_warmup, RobertaTokenizer, AutoTokenizer\n","\n","model_name ='akahana/indonesia-emotion-roberta'\n","tokenizer = AutoTokenizer.from_pretrained(model_name)\n","input_id = [tokenizer.encode(sent,  add_special_tokens=True, max_length=280, truncation=True, padding='max_length') for sent in tweet]\n"],"metadata":{"id":"sHsRj4C3q0Tq","executionInfo":{"status":"ok","timestamp":1651378680150,"user_tz":-420,"elapsed":8423,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"colab":{"base_uri":"https://localhost:8080/","height":177,"referenced_widgets":["49e5076bfff94ca9a10552adceb882c8","bbd3ee567ed844dfa733361b6b43295e","a346078fb6f54a9791e087e30c594828","1c61912894424c9cb0cd39f6d0020b75","dea98e6853a54c8499e0ba06f9b7e995","f89121ceaa0d40558d2e0851bebd3889","de01b3753346448499c5c63484838bd7","d252f4cf4a5f4c2484064761ccce4707","6ef4ee5f0aa44593bd0a16da452c9e50","0b438f2f4b6e43c0bdaa9909b3f5e0f5","7a44fa3dc1324f88af28273a769795ac","0a0781d4c4394a608d1d6b524f75dba6","4bdfc265a7ec4e6bbd9fc221db1bd16c","2ceadb5b746f4af587327324b1d76b64","2cb525ced1ab475c9a2e68541db8faab","f6a0c3c081c746359437a8ed5192cd23","1b18d16de4e14e1b8bc6d9200b9b3002","2fc8a8080e764bb8939f0cf72d06854e","2d71e428dcf345739f0d50e4e39e3ae6","ace5197c28054ab186a4964eaf0e21a8","ba3898055aab4039aec5a1995510a0ff","6ccd745486e541b7b7b685e9b0d658d5","a4a287a10f514fc2858b5298f6b81efd","9a1c5a6d1ad74fd48a3d2896e6a5061f","d8ac1ba319194d40902248f7cd8b57e8","0a1659e3fd28470292329e73df2ee76f","e99fabddc4534defb1d528142c9c8626","32fc3f3eae4d4eea846479d5550e8c1e","47e5382859da4e19aff813f8095ac234","bb58fa691af047688ad614d6c631d58f","8c614aff912b4b6ebc0486a36170cbb6","74bc89aa47944b02ae5a6ebe7d1af29e","38d92ea5b69e43cda34ada7e227af018","1545b265d85a416ca1ce3fa174cc4533","b93730345bd04edc870d23c7b2293e5f","e8e88106787e4f0caad8a03fbfe3994d","e21ced7dd14c4f54b941b51b7125403d","df58806ad6f44ba4ad96fb815695d38f","8802efadf22741fd862210f873833f45","f6e69c25fe774d31a89c8043c4bb4c78","05373ead85f14b0b97bb5e499ee84ff4","d11b77342d3b422282cb3397cfd14c30","bded2321dcdd48578b2e0d7253c9952c","f5384b6664e54f429ffec3a454a010a5","c40491c19ff04a54a509ebc260806467","b13e7fc7d1664972a11469567124a3bc","3b58a700f78b467598ee83f6627098e5","9627ee42412445dd9b61086cf1dbb13c","3ac62c8525834ef4b0b417cbbba2dcd6","faa49dee82444a7b81c7366b919da760","9205e10dcb32439b9411a1e4726d0d2c","a5e2f752470e40d49539dbd3fe5e87de","9e0a00b5cdb94fc399568dc01ef01252","19c5f4e5ea674be1a9fd61f700088873","3862c2e51c1c4e0dbe6e554fe2614dd8"]},"outputId":"f0b5649c-99b5-4430-f1e0-262ec85c4f1f"},"execution_count":15,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/352 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"49e5076bfff94ca9a10552adceb882c8"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/789k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0a0781d4c4394a608d1d6b524f75dba6"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/456k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a4a287a10f514fc2858b5298f6b81efd"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/1.31M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1545b265d85a416ca1ce3fa174cc4533"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/239 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c40491c19ff04a54a509ebc260806467"}},"metadata":{}}]},{"cell_type":"code","source":["attention_masks = [[float(i>0) for i in seq] for seq in input_id]"],"metadata":{"id":"lg-37zR0rAWM","executionInfo":{"status":"ok","timestamp":1651378680640,"user_tz":-420,"elapsed":495,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":16,"outputs":[]},{"cell_type":"code","source":["input_id[3][len(input_id[3])-1]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5Bs3fL0ErDQH","executionInfo":{"status":"ok","timestamp":1651378681115,"user_tz":-420,"elapsed":478,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"37839056-9e11-4367-847b-979295a235f8"},"execution_count":17,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1"]},"metadata":{},"execution_count":17}]},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split\n","\n","# Split train and validation with 10:1 ratio\n","train_inputs, validation_input, train_labels, validation_labels  = train_test_split(input_id, labels,random_state=32, test_size=0.1)\n","# We only need to split attention mask into 2 variable, labels is not needed for this.\n","train_masks, validation_masks, label_mask,_  = train_test_split(attention_masks, labels,random_state=32, test_size=0.1)\n","\n","# From the train_input, split again to train and prediction with 10:1 ratio\n","train_inputs, prediction_input, train_labels, prediction_labels  = train_test_split(train_inputs, train_labels,random_state=3, test_size=0.2)\n","train_masks, prediction_masks, _,_  = train_test_split(train_masks, label_mask,random_state=3, test_size=0.2)"],"metadata":{"id":"h8O2SdMgrIdB","executionInfo":{"status":"ok","timestamp":1651378681116,"user_tz":-420,"elapsed":5,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":18,"outputs":[]},{"cell_type":"code","source":["import torch\n","\n","train_inputs = torch.tensor(train_inputs)\n","validation_inputs = torch.tensor(validation_input)\n","prediction_input = torch.tensor(prediction_input)\n","\n","train_labels = torch.tensor(train_labels, dtype=torch.long)\n","validation_labels = torch.tensor(validation_labels, dtype=torch.long)\n","prediction_labels = torch.tensor(prediction_labels, dtype=torch.long)\n","\n","train_masks = torch.tensor(train_masks)\n","validation_masks = torch.tensor(validation_masks)\n","prediction_masks = torch.tensor(prediction_masks)"],"metadata":{"id":"TnAN6ZHPrKYf","executionInfo":{"status":"ok","timestamp":1651378681624,"user_tz":-420,"elapsed":512,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":19,"outputs":[]},{"cell_type":"code","source":["from torch.utils.data import TensorDataset, DataLoader, RandomSampler, SequentialSampler\n","\n","batch_size = 8\n","\n","# Create the DataLoader for our training set.\n","train_data = TensorDataset(train_inputs, train_masks, train_labels)\n","train_sampler = RandomSampler(train_data)\n","train_dataloader = DataLoader(train_data, sampler=train_sampler, batch_size=batch_size)\n","\n","# Create the DataLoader for our validation set.\n","validation_data = TensorDataset(validation_inputs, validation_masks, validation_labels)\n","validation_sampler = SequentialSampler(validation_data)\n","validation_dataloader = DataLoader(validation_data, sampler=validation_sampler, batch_size=batch_size)\n","\n","prediction_data = TensorDataset(prediction_input, prediction_masks, prediction_labels)\n","prediction_sampler = RandomSampler(prediction_data)\n","prediction_dataloader = DataLoader(prediction_data, sampler=prediction_sampler, batch_size=batch_size)"],"metadata":{"id":"7wR_Q9jyrpE2","executionInfo":{"status":"ok","timestamp":1651378681625,"user_tz":-420,"elapsed":5,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":20,"outputs":[]},{"cell_type":"code","source":["from transformers import AutoModelForSequenceClassification\n","\n","model = AutoModelForSequenceClassification.from_pretrained(\n","    model_name, \n","    num_labels = 5, \n","    hidden_dropout_prob = 0.1, \n","    output_attentions = False, \n","    output_hidden_states = False, \n",")\n","\n","for name, param in model.named_parameters():\n","    if name.startswith('roberta.encoder.layer.4'):\n","      param.requires_grad = False\n","    if name.startswith('roberta.encoder.layer.5'):\n","      param.requires_grad = False\n","    if name.startswith('roberta.encoder.layer.6'):\n","      param.requires_grad = False\n","    if name.startswith('roberta.encoder.layer.7'):\n","      param.requires_grad = False\n","    if name.startswith('roberta.encoder.layer.8'):\n","      param.requires_grad = False\n","    if name.startswith('roberta.encoder.layer.9'):\n","      param.requires_grad = False\n","    else:\n","      param.requires_grad = True\n","    \n","\n","model.to(device)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["b002b8716fbe4b36b93623df9d64e1b4","0756e71eb1354c428a96c608dd1258ef","e78bffd8531e4d64ba62f693d28ca2fb","9020581a34a342a1aba83913c4ddc476","f19d6ced1e4f4441a1a3c4fc92dc4a7f","275a3af047364f539a00d4823ef8863a","7802122baed24fc5ae894a2facc2352a","8633864eff3d40a7a2f06d284f30c94f","aef8d6d3bd184658952d65b90e5cb177","176618c770244fca925be080e4161539","23dfa750b9d04731b6e7a3f5d0036fbd","71105c3a43c84d83b60ba4d704efaa71","d29cf25a07ea4ac7a960909d88fbd12f","094c7a6af2e04eddb7bd2fc944c60445","c069bfc4adb24865a3b4228174365bef","78d45a663b4c4403a2573c84a7ba653c","db7ad0cd2aeb4443947ead8601a03934","000cca25b85545e5bf4939171fccc180","f2e68040eee8459c98c560d35f01c27c","0130374e41414c7f8e26234aaf1fadfb","d0be7b359322483899d2662b26b306a5","4b61cd05673e4cbdb5fb1dbdaf7141ae"]},"id":"39SvBjEFrqae","executionInfo":{"status":"ok","timestamp":1651378728429,"user_tz":-420,"elapsed":46809,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"7b0bee62-0d20-4f93-bcc9-318f02d82056"},"execution_count":21,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/0.99k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b002b8716fbe4b36b93623df9d64e1b4"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/476M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"71105c3a43c84d83b60ba4d704efaa71"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["RobertaForSequenceClassification(\n","  (roberta): RobertaModel(\n","    (embeddings): RobertaEmbeddings(\n","      (word_embeddings): Embedding(50265, 768, padding_idx=1)\n","      (position_embeddings): Embedding(514, 768, padding_idx=1)\n","      (token_type_embeddings): Embedding(1, 768)\n","      (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","      (dropout): Dropout(p=0.1, inplace=False)\n","    )\n","    (encoder): RobertaEncoder(\n","      (layer): ModuleList(\n","        (0): RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (1): RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (2): RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (3): RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (4): RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (5): RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (6): RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (7): RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (8): RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (9): RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (10): RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","        (11): RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","      )\n","    )\n","  )\n","  (classifier): RobertaClassificationHead(\n","    (dense): Linear(in_features=768, out_features=768, bias=True)\n","    (dropout): Dropout(p=0.1, inplace=False)\n","    (out_proj): Linear(in_features=768, out_features=5, bias=True)\n","  )\n",")"]},"metadata":{},"execution_count":21}]},{"cell_type":"code","source":["params = list(model.named_parameters())\n","\n","for p in params[-4:]:\n","    print(\"{:<55} {:>12}\".format(p[0], str(tuple(p[1].size()))))\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"xemkZKc5rs7l","executionInfo":{"status":"ok","timestamp":1651378728430,"user_tz":-420,"elapsed":13,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"a14cedeb-af8f-4095-8bb1-e3d497493835"},"execution_count":22,"outputs":[{"output_type":"stream","name":"stdout","text":["classifier.dense.weight                                   (768, 768)\n","classifier.dense.bias                                         (768,)\n","classifier.out_proj.weight                                  (5, 768)\n","classifier.out_proj.bias                                        (5,)\n"]}]},{"cell_type":"code","source":["optimizer = AdamW(model.parameters(), lr = 2e-5, eps=1e-8, correct_bias=False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lzy2WeDkrwCT","executionInfo":{"status":"ok","timestamp":1651378728430,"user_tz":-420,"elapsed":9,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"6714028f-d593-4bee-98db-4b5c111ad6f7"},"execution_count":23,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/transformers/optimization.py:309: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  FutureWarning,\n"]}]},{"cell_type":"code","source":["from transformers import get_linear_schedule_with_warmup\n","\n","epochs = 3\n","\n","total_steps = len(train_dataloader) * epochs\n","\n","scheduler = get_linear_schedule_with_warmup(optimizer, num_warmup_steps = 0, num_training_steps = total_steps)"],"metadata":{"id":"WiFiakHNrx2e","executionInfo":{"status":"ok","timestamp":1651378728431,"user_tz":-420,"elapsed":8,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":24,"outputs":[]},{"cell_type":"code","source":["import numpy as np\n","\n","# Function to calculate the accuracy of our predictions vs labels\n","def flat_accuracy(preds, labels):\n","    pred_flat = np.argmax(preds, axis=1).flatten()\n","    labels_flat = labels.flatten()\n","    return np.sum(pred_flat == labels_flat) / len(labels_flat)"],"metadata":{"id":"t4Q8nOUer0pP","executionInfo":{"status":"ok","timestamp":1651378728431,"user_tz":-420,"elapsed":7,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":25,"outputs":[]},{"cell_type":"code","source":["import time\n","import datetime\n","\n","def format_time(elapsed):\n","    '''\n","    Takes a time in seconds and returns a string hh:mm:ss\n","    '''\n","    # Round to the nearest second.\n","    elapsed_rounded = int(round((elapsed)))\n","    \n","    # Format as hh:mm:ss\n","    return str(datetime.timedelta(seconds=elapsed_rounded))"],"metadata":{"id":"ZFSeWsXgr27x","executionInfo":{"status":"ok","timestamp":1651378728432,"user_tz":-420,"elapsed":8,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":26,"outputs":[]},{"cell_type":"code","source":["import random\n","\n","# This training code is based on the `run_glue.py` script here:\n","# https://github.com/huggingface/transformers/blob/5bfcd0485ece086ebcbed2d008813037968a9e58/examples/run_glue.py#L128\n","\n","\n","# Set the seed value all over the place to make this reproducible.\n","seed_val = 42\n","\n","random.seed(seed_val)\n","np.random.seed(seed_val)\n","torch.manual_seed(seed_val)\n","torch.cuda.manual_seed_all(seed_val)\n","\n","# Store the average loss after each epoch so we can plot them.\n","train_loss_values = []\n","eval_loss_values = []\n","\n","# For each epoch...\n","for epoch_i in range(0, epochs):\n","    \n","    # ========================================\n","    #               Training\n","    # ========================================\n","    \n","    # Perform one full pass over the training set.\n","\n","    print(\"\")\n","    print('======== Epoch {:} / {:} ========'.format(epoch_i + 1, epochs))\n","    print('Training...')\n","\n","    # Measure how long the training epoch takes.\n","    t0 = time.time()\n","\n","    # Reset the total loss for this epoch.\n","    total_loss = 0\n","\n","    # Put the model into training mode. Don't be mislead--the call to \n","    # `train` just changes the *mode*, it doesn't *perform* the training.\n","    # `dropout` and `batchnorm` layers behave differently during training\n","    # vs. test (source: https://stackoverflow.com/questions/51433378/what-does-model-train-do-in-pytorch)\n","    model.train()\n","\n","    # For each batch of training data...\n","    for step, batch in enumerate(train_dataloader):\n","\n","        # Progress update every 40 batches.\n","        if step % 40 == 0 and not step == 0:\n","            # Calculate elapsed time in minutes.\n","            elapsed = format_time(time.time() - t0)\n","            \n","            # Report progress.\n","            print('  Batch {:>5,}  of  {:>5,}.    Elapsed: {:}.'.format(step, len(train_dataloader), elapsed))\n","\n","        # Unpack this training batch from our dataloader. \n","        #\n","        # As we unpack the batch, we'll also copy each tensor to the GPU using the \n","        # `to` method.\n","        #\n","        # `batch` contains three pytorch tensors:\n","        #   [0]: input ids \n","        #   [1]: attention masks\n","        #   [2]: labels \n","        b_input_ids = batch[0].to(device)\n","        b_input_mask = batch[1].to(device)\n","        b_labels = batch[2].to(device)\n","\n","        # Always clear any previously calculated gradients before performing a\n","        # backward pass. PyTorch doesn't do this automatically because \n","        # accumulating the gradients is \"convenient while training RNNs\". \n","        # (source: https://stackoverflow.com/questions/48001598/why-do-we-need-to-call-zero-grad-in-pytorch)\n","        model.zero_grad()        \n","\n","        # Perform a forward pass (evaluate the model on this training batch).\n","        # This will return the loss (rather than the model output) because we\n","        # have provided the `labels`.\n","        # The documentation for this `model` function is here: \n","        # https://huggingface.co/transformers/v2.2.0/model_doc/bert.html#transformers.BertForSequenceClassification\n","        outputs = model(b_input_ids, \n","                    token_type_ids=None, \n","                    attention_mask=b_input_mask, \n","                    labels=b_labels)\n","        \n","        # The call to `model` always returns a tuple, so we need to pull the \n","        # loss value out of the tuple.\n","        loss = outputs.loss\n","\n","        # Accumulate the training loss over all of the batches so that we can\n","        # calculate the average loss at the end. `loss` is a Tensor containing a\n","        # single value; the `.item()` function just returns the Python value \n","        # from the tensor.\n","        total_loss += loss.item()\n","\n","        # Perform a backward pass to calculate the gradients.\n","        loss.backward()\n","\n","        # Clip the norm of the gradients to 1.0.\n","        # This is to help prevent the \"exploding gradients\" problem.\n","        torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)\n","\n","        # Update parameters and take a step using the computed gradient.\n","        # The optimizer dictates the \"update rule\"--how the parameters are\n","        # modified based on their gradients, the learning rate, etc.\n","        optimizer.step()\n","\n","        # Update the learning rate.\n","        scheduler.step()\n","\n","    # Calculate the average loss over the training data.\n","    avg_train_loss = total_loss / len(train_dataloader)            \n","    \n","    # Store the loss value for plotting the learning curve.\n","    train_loss_values.append(avg_train_loss)\n","\n","    print(\"\")\n","    print(\"  Average training loss: {0:.2f}\".format(avg_train_loss))\n","    print(\"  Training epcoh took: {:}\".format(format_time(time.time() - t0)))\n","        \n","    # ========================================\n","    #               Validation\n","    # ========================================\n","    # After the completion of each training epoch, measure our performance on\n","    # our validation set.\n","\n","    print(\"\")\n","    print(\"Running Validation...\")\n","\n","    t0 = time.time()\n","\n","    # Put the model in evaluation mode--the dropout layers behave differently\n","    # during evaluation.\n","    model.eval()\n","\n","    # Tracking variables \n","    eval_loss, eval_accuracy = 0, 0\n","    nb_eval_steps, nb_eval_examples = 0, 0\n","\n","    # Evaluate data for one epoch\n","    for batch in validation_dataloader:\n","        \n","        # Add batch to GPU\n","        batch = tuple(t.to(device) for t in batch)\n","        \n","        # Unpack the inputs from our dataloader\n","        b_input_ids, b_input_mask, b_labels = batch\n","        \n","        # Telling the model not to compute or store gradients, saving memory and\n","        # speeding up validation\n","        with torch.no_grad():        \n","\n","            # Forward pass, calculate logit predictions.\n","            # This will return the logits rather than the loss because we have\n","            # not provided labels.\n","            # token_type_ids is the same as the \"segment ids\", which \n","            # differentiates sentence 1 and 2 in 2-sentence tasks.\n","            # The documentation for this `model` function is here: \n","            # https://huggingface.co/transformers/v2.2.0/model_doc/bert.html#transformers.BertForSequenceClassification\n","            outputs = model(b_input_ids, \n","                            token_type_ids=None,\n","                            labels=b_labels,\n","                            attention_mask=b_input_mask)\n","        \n","        # Get the \"logits\" output by the model. The \"logits\" are the output\n","        # values prior to applying an activation function like the softmax.\n","        logits = outputs.logits\n","\n","        # Move logits and labels to CPU\n","        logits = logits.detach().cpu().numpy()\n","        label_ids = b_labels.to('cpu').numpy()\n","        \n","        # Calculate the accuracy for this batch of test sentences.\n","        tmp_eval_accuracy = flat_accuracy(logits, label_ids)\n","        \n","        # Accumulate the total accuracy.\n","        eval_accuracy += tmp_eval_accuracy\n","\n","        loss = outputs.loss\n","\n","        eval_loss += loss.item()\n","\n","        # Track the number of batches\n","        nb_eval_steps += 1\n","\n","    avg_eval_loss = eval_loss / len(validation_dataloader)            \n","    \n","    # Store the loss value for plotting the learning curve.\n","    eval_loss_values.append(avg_eval_loss)\n","\n","        \n","    # Report the final accuracy for this validation run.\n","    print(\"  Accuracy: {0:.2f}\".format(eval_accuracy/nb_eval_steps))\n","    print(\" validation loss : {:.2f}\".format(avg_eval_loss))\n","    print(\"  Validation took: {:}\".format(format_time(time.time() - t0)))\n","\n","print(\"\")\n","print(\"Training complete!\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HZ5fItQNr4zd","outputId":"4f952732-0646-4a53-8b9c-7024a7cf889a","executionInfo":{"status":"ok","timestamp":1651379710659,"user_tz":-420,"elapsed":982235,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":27,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","======== Epoch 1 / 3 ========\n","Training...\n","  Batch    40  of    396.    Elapsed: 0:00:31.\n","  Batch    80  of    396.    Elapsed: 0:01:02.\n","  Batch   120  of    396.    Elapsed: 0:01:34.\n","  Batch   160  of    396.    Elapsed: 0:02:05.\n","  Batch   200  of    396.    Elapsed: 0:02:37.\n","  Batch   240  of    396.    Elapsed: 0:03:08.\n","  Batch   280  of    396.    Elapsed: 0:03:40.\n","  Batch   320  of    396.    Elapsed: 0:04:12.\n","  Batch   360  of    396.    Elapsed: 0:04:43.\n","\n","  Average training loss: 0.58\n","  Training epcoh took: 0:05:12\n","\n","Running Validation...\n","  Accuracy: 0.88\n"," validation loss : 0.39\n","  Validation took: 0:00:15\n","\n","======== Epoch 2 / 3 ========\n","Training...\n","  Batch    40  of    396.    Elapsed: 0:00:32.\n","  Batch    80  of    396.    Elapsed: 0:01:03.\n","  Batch   120  of    396.    Elapsed: 0:01:35.\n","  Batch   160  of    396.    Elapsed: 0:02:06.\n","  Batch   200  of    396.    Elapsed: 0:02:38.\n","  Batch   240  of    396.    Elapsed: 0:03:10.\n","  Batch   280  of    396.    Elapsed: 0:03:41.\n","  Batch   320  of    396.    Elapsed: 0:04:13.\n","  Batch   360  of    396.    Elapsed: 0:04:44.\n","\n","  Average training loss: 0.20\n","  Training epcoh took: 0:05:13\n","\n","Running Validation...\n","  Accuracy: 0.90\n"," validation loss : 0.44\n","  Validation took: 0:00:15\n","\n","======== Epoch 3 / 3 ========\n","Training...\n","  Batch    40  of    396.    Elapsed: 0:00:32.\n","  Batch    80  of    396.    Elapsed: 0:01:03.\n","  Batch   120  of    396.    Elapsed: 0:01:35.\n","  Batch   160  of    396.    Elapsed: 0:02:06.\n","  Batch   200  of    396.    Elapsed: 0:02:38.\n","  Batch   240  of    396.    Elapsed: 0:03:10.\n","  Batch   280  of    396.    Elapsed: 0:03:41.\n","  Batch   320  of    396.    Elapsed: 0:04:13.\n","  Batch   360  of    396.    Elapsed: 0:04:45.\n","\n","  Average training loss: 0.09\n","  Training epcoh took: 0:05:13\n","\n","Running Validation...\n","  Accuracy: 0.92\n"," validation loss : 0.45\n","  Validation took: 0:00:15\n","\n","Training complete!\n"]}]},{"cell_type":"code","source":["from matplotlib import pyplot as plt\n","\n","plt.plot(train_loss_values, label=\"train_loss\")\n","plt.plot(eval_loss_values, label=\"eval_loss\")\n","plt.title('Loss...')\n","plt.legend(loc = 'best')\n","plt.show()"],"metadata":{"id":"flLdczRpr7zT","colab":{"base_uri":"https://localhost:8080/","height":281},"executionInfo":{"status":"ok","timestamp":1651379710660,"user_tz":-420,"elapsed":19,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"67e6b14e-c0b2-4596-853a-bcb41709bfbb"},"execution_count":28,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAXQAAAEICAYAAABPgw/pAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3deXxU5dn/8c81k30hZAVMwhKWsCiLJBBFBYoLrriLK3u0irW12vo8Wqv+eB6tWmt9pG6AgMpiUSttpVYRpKJAAgbZEghhC6gJYV8CSeb+/TGHOIQAk2Qms+R6v155MWebc83J+PXOfc65jxhjUEopFfhsvi5AKaWUZ2igK6VUkNBAV0qpIKGBrpRSQUIDXSmlgoQGulJKBQkNdKWUChIa6CqoiMhWEbnU13Uo5Qsa6EopFSQ00FXQE5FwEXlZRHZZPy+LSLi1LElE/iEi+0Rkj4j8R0Rs1rLfishOETkoIkUiMsy3n0SpMwvxdQFKNYPHgRygL2CAj4EngN8BvwZKgWRr3RzAiEgmMBHINsbsEpGOgL15y1aqYbSFrlqCO4FnjDFlxphy4GngbmtZFdAO6GCMqTLG/Mc4BziqAcKBniISaozZaozZ7JPqlXKTBrpqCc4BtrlMb7PmAbwAFAP/FpESEXkMwBhTDPwSeAooE5E5InIOSvkxDXTVEuwCOrhMt7fmYYw5aIz5tTEmA7gOePhEX7kxZpYx5iJrWwP8oXnLVqphNNBVMAoVkYgTP8Bs4AkRSRaRJOBJ4F0AEblGRLqIiAD7cXa1OEQkU0R+Zp08rQSOAg7ffByl3KOBroLRJzgD+MRPBJAPfAesAVYBk6x1uwKfA4eAb4C/GGMW4ew/fw7YDfwApAD/BSAid4rIuhM7E5HXReR1l+l1InKnNz+gUvURfcCFUkoFB22hK6VUkNBAV0qpIKGBrpRSQUIDXSmlgoRbt/6LyHDgzzhvfZ5ijHmunnVuxXkThgFWG2PuONN7JiUlmY4dOza0XqWUatFWrly52xiTXN+yswa6iNiBycBlOMe8yBOR+caY9S7rdMV5SdcgY8xeEUk52/t27NiR/Px8dz+DUkopQES2nW6ZO10uA4BiY0yJMeY4MAcYUWedCcBkY8xeAGNMWWOLVUop1TjuBHoqsMNlutSa56ob0E1ElorIMquL5hQikisi+SKSX15e3riKlVJK1ctTJ0VDcN5xNwS4HXhLRFrXXckY86YxJssYk5WcXG8XkFJKqUZy56ToTiDdZTrNmueqFFhujKkCtojIRpwBn+eRKpVSAaGqqorS0lIqKyt9XUrAi4iIIC0tjdDQULe3cSfQ84CuItIJZ5CPBOpewfI3nC3zt63Bj7oBJW5XoZQKCqWlpcTGxtKxY0ec452pxjDGUFFRQWlpKZ06dXJ7u7N2uRhjqnE+ueVTYAPwvjFmnYg8IyLXWat9ClSIyHpgEfCoMaaiwZ9CKRXQKisrSUxM1DBvIhEhMTGxwX/puHUdujHmE5wj2LnOe9LltQEetn6UUi2YhrlnNOY4Btydolt3H+b5fxXicOgokUop5SrgAv3f63/gL4s38/jf1mqoK6WUi4AL9AkXZ/DA0M7MXrGd3328Fh3PXSl1wr59+/jLX/7S4O2uuuoq9u3b1+DtRo8ezbx58xq8nbcEXKCLCI9cnsnPh3TmveXbefLjdRrqSing9IFeXV19xu0++eQTWrc+5daZgOPWSVF/IyL85opMHA7DG0tKsNuE31/bU0/GKOVHnv77OtbvOuDR9+x5Tit+f22v0y5/7LHH2Lx5M3379iU0NJSIiAji4+MpLCxk48aNXH/99ezYsYPKykoeeughcnNzgZ/Gljp06BBXXnklF110EV9//TWpqal8/PHHREZGnrW2hQsX8sgjj1BdXU12djavvfYa4eHhPPbYY8yfP5+QkBAuv/xyXnzxRf7617/y9NNPY7fbiYuLY8mSJR45PgEZ6OAM9ceu7I7DGN76zxZE4MlrNNSVasmee+451q5dS0FBAYsXL+bqq69m7dq1tddyT5s2jYSEBI4ePUp2djY33XQTiYmJJ73Hpk2bmD17Nm+99Ra33norH3zwAXfdddcZ91tZWcno0aNZuHAh3bp145577uG1117j7rvv5qOPPqKwsBARqe3WeeaZZ/j0009JTU1tVFfP6QRsoIMz1P/7qh7UOGDa0i3YRHji6h4a6kr5gTO1pJvLgAEDTrox55VXXuGjjz4CYMeOHWzatOmUQO/UqRN9+/YFoH///mzduvWs+ykqKqJTp05069YNgFGjRjF58mQmTpxIREQE48aN45prruGaa64BYNCgQYwePZpbb72VG2+80RMfFQjAPvS6RITfXdOD0Rd2ZOpXW3h2QaH2qSulAIiOjq59vXjxYj7//HO++eYbVq9eTb9+/eq9cSc8PLz2td1uP2v/+5mEhISwYsUKbr75Zv7xj38wfLhz3MLXX3+dSZMmsWPHDvr3709FhWfuwwzoFvoJIs4+dGMMby4pQQQeG95dW+pKtTCxsbEcPHiw3mX79+8nPj6eqKgoCgsLWbZsmcf2m5mZydatWykuLqZLly688847DB48mEOHDnHkyBGuuuoqBg0aREZGBgCbN29m4MCBDBw4kAULFrBjx45T/lJojKAIdHCG+lPX9aLGGN74sgS7CI9ekamhrlQLkpiYyKBBgzj33HOJjIykTZs2tcuGDx/O66+/To8ePcjMzCQnJ8dj+42IiODtt9/mlltuqT0pet9997Fnzx5GjBhBZWUlxhheeuklAB599FE2bdqEMYZhw4bRp08fj9QhvuqeyMrKMt54YpHDYXji47XMWr6diUO78OvLu2moK9VMNmzYQI8ePXxdRtCo73iKyEpjTFZ96wdNC/0Em02YNOJcjDG8uqgYm014+LJuvi5LKaW8LugCHZyh/j/Xn4fDAa8s3IRN4JeXaqgrpRrngQceYOnSpSfNe+ihhxgzZoyPKqpfUAY6OEP92RvPo8YYXv58E3YRHhzW1ddlKaUC0OTJk31dgluCNtDBGep/uKk3DmP442cbsdmEB4Z28XVZSinlFUEd6AB2m/DCzX0wBl74tAibCD8f0tnXZSmllMcFfaCDM9RfvKUPDmP4w78KsQncO1hDXSkVXFpEoIMz1P94Sx8cBp5dUIjdJoy/OMPXZSmllMcE/K3/DRFit/GnW/twde92TPrnBqZ+tcXXJSml/FTHjh3ZvXv3aZfHxMQ0YzXuaTEt9BNC7DZevq0vxhj+3z/WYxMYM8j9p2orpZS/anGBDhBqt/Hnkf1wOL7l6b+vx24T7rmgo6/LUiq4LHgMfljj2fdsex5c+dxZV3v33Xd55ZVXOH78OAMHDqR3795s3bqVF154AYDp06eTn5/Pq6++etox0t1ljOE3v/kNCxYsQER44oknuO222/j++++57bbbOHDgANXV1bz22mtceOGFjBs3jvz8fESEsWPH8qtf/apRh6I+LTLQwRnqr9zej4mzVvHkx+sQEe7O6eDrspRSTbRhwwbmzp3L0qVLCQ0N5f777ycmJoaPPvqoNtDnzp3L448/Drg3RvqZfPjhhxQUFLB69Wp2795NdnY2l1xyCbNmzeKKK67g8ccfp6amhiNHjlBQUMDOnTtZu3YtgEfHQocWHOgAYSE2Xr3jfO5/bxW/+9tabAJ3DtRQV8oj3GhJe8PChQtZuXIl2dnZABw9epSUlBQyMjJYtmwZXbt2pbCwkEGDBgHujZF+Jl999RW33347drudNm3aMHjwYPLy8sjOzmbs2LFUVVVx/fXX07dvXzIyMigpKeHBBx/k6quv5vLLL/foZ29RJ0XrExZiY/Kd/RjWPYXHP1rL7BXbfV2SUqoJjDGMGjWKgoICCgoKKCoq4qmnnmLkyJG8//77fPDBB9xwww2IiNtjpDfGJZdcwpIlS0hNTWX06NHMnDmT+Ph4Vq9ezZAhQ3j99dcZP368R/Z1QosPdIDwEDt/uet8hmYm818fruH9vB2+Lkkp1UjDhg1j3rx5lJWVAbBnzx62bdvGDTfcwMcff8zs2bMZOXIk4Jkx0i+++GLmzp1LTU0N5eXlLFmyhAEDBrBt2zbatGnDhAkTGD9+PKtWrWL37t04HA5uuukmJk2axKpVqzz62Vt0l4ur8BA7r93Vn3vfWclvP/wOEbglK93XZSmlGqhnz55MmjSJyy+/HIfDQWhoKJMnT6ZDhw706NGD9evXM2DAAMAzY6TfcMMNfPPNN/Tp0wcR4fnnn6dt27bMmDGDF154gdDQUGJiYpg5cyY7d+5kzJgxOBwOAJ599lmPfvagGw+9qSqrapgwM5+vinfz4s19uKl/mq9LUipg6HjontXQ8dC1y6WOiFA7b92TxaDOSTwybzUffVvq65KUUsot2uVSjxOhPm5GHr9+fzU2EUb0TfV1WUqpZlZRUcGwYcNOmb9w4UKPPAPU0zTQTyMyzM7UUdmMnZ7Hr+YWICJc1+ccX5ellN8zxgTNYx8TExMpKCjwyb4b0x2uXS5nEBlmZ+roLLI7JvDLOd/yj+92+bokpfxaREQEFRUVjQoj9RNjDBUVFURERDRoO7da6CIyHPgzYAemGGOeq7N8NPACsNOa9aoxZkqDKvFTUWEhTBudzZi383hoTgE2Ea46r52vy1LKL6WlpVFaWkp5ebmvSwl4ERERpKU17KKMswa6iNiBycBlQCmQJyLzjTHr66w61xgzsUF7DxDR4SG8PSabUdNW8ODsb7EJDD9XQ12pukJDQ+nUSQe78xV3ulwGAMXGmBJjzHFgDjDCu2X5n+jwEKaPHUDf9NZMnPUtn677wdclKaXUSdwJ9FTA9dbJUmteXTeJyHciMk9E6r0jR0RyRSRfRPID8U+ymPAQpo/J5ry0OB54bxWfrf/R1yUppVQtT50U/TvQ0RjTG/gMmFHfSsaYN40xWcaYrOTkZA/tunnFRoQyY+wAeqXGcf97K1m4QUNdKeUf3An0nYBrizuNn05+AmCMqTDGHLMmpwD9PVOef2oVEcrMsQPo0a4VP393FYsKy3xdklJKuRXoeUBXEekkImHASGC+6woi4nqG8Dpgg+dK9E9xkaG8M3YgmW1jufedlSwu0lBXSvnWWQPdGFMNTAQ+xRnU7xtj1onIMyJynbXaL0RknYisBn4BjPZWwf4kLiqUd8YNoGubGHLfWcmXGwPvvIBSKnjo4FwesO/Ice54azmbyw8xZVQWF3cNzPMDSin/p4NzeVnrqDDeGz+QTknRjJ+Rz9Li0z8pXCmlvEUD3UPio8OYNSGHTknRjJuRx9ebNdSVUs1LA92DEqKdLfUOCdGMnZ7HspIKX5eklGpBNNA9LDEmnPcmDCQ9Pooxb+exXENdKdVMNNC9ICkmnFkTckiNj2TM9Dzytu7xdUlKqRZAA91LkmPDmTVhIG3jIhg9bQUrt2moK6W8SwPdi1JiI5gzIYc2rSIYNS2PVdv3+rokpVQQ00D3spRWEcyakENSTBijpq7gWw11pZSXaKA3g7ZxEczOzSEhJox7pq5g9Y59vi5JKRWENNCbSbu4SGZPyCE+Ooy7pi7nu1INdaWUZ2mgN6NzWkcyOzeH1lGh3DVlOWt37vd1SUqpIKKB3sxSWztb6rERodypoa6U8iANdB9Ii49iTm4OMeEh3DV1Oet3HfB1SUopT3I44PgROLIHDnwPe0qgbAPs+ha2L4OD3nmEpY626EPbK44w8s1vOFpVw6wJOfRo18rXJSkVPBw1UH0Mqitdfo5B1VGX+cegus70KcvrbF9dCVWVZ15ec/zMtV39EmSPa9THOtNoixroPrat4jC3vbGM4zUOZk/IIbNtrK9LUspzHDV1gvAsYepOWLq73FHVtNptIRASCSHhEBLh/De0znRDl4dEQGgEJGVCXH2PZj47DXQ/t3X3YW578xuqawyzc3Po1kZDXXmQa6hWHfVMWLq7vMmhGuq5MHUrbK159nCwh3jm+HuYBnoAKCk/xMg3l+EwhtkTcuiqoR5cHDV1WqfNEKYnWsCO6qbVbgv1fpietNwlYG12zxz/IKKBHiA2W6FuDMzJzaFLSoyvS2o5HDXOE1X7S+Hg91B1xL2wPGPfq8t0U0PVHuYSdhFeDNN6lmuo+hUN9ABSXHaQkW8uR8QZ6p2TNdQ94vhhZ1jv3wH7dlivren9O+DArrOHrr2evtCTWpV1pz0UtvZwsOkFacpJAz3AbPrxILe/tQybCHPvvYBOSdG+Lsm/ORxwuNwK6O0/hfU+K6z3l8LROqNdih1anQNx6RCX5vxpne6cjm0HYdEnh62GqvITGugBqOiHg9zx1jJC7Tbm5ObQsSWHelWlS2u6Tsv6xHTdy8TCYq2ATnMJ7fSf5sW09duTXkqdiQZ6gCr84QB3vLWc8BBnqHdIDMJQNwaOVPwUzrXdIS6Bfbi8zkbibEXXtqpPhLZLazuytU8+jlLepoEewNbvOsCdU5YRGWpnTu4FtE+M8nVJDVN9HA7srNPCrtOPXX305G1Co07fso5Lg1apYA/1zedRysc00APcul37uXPKcqLDQpiTm0N6gp+EujFQue/0Lev9pdYtznW+YzFtfgrnui3r1u0hMh5EfPKRlPJ3GuhBYO1OZ6jHRjhDPS2+GUK9phoO7jq537ruFSLHD528jT381JOMrq3tVqnOq0OUUo2igR4k1pTu584py4iLCmVO7gWkto5s2htWHnAJ57pXh5Q6w9w4Tt4mKvHUlrVrP3Z0sraulfIiDfQgsnrHPu6aupz4qDDm3ptDu7jThLqjBg79aAX09pNb1Sf+rawzdK8t1Dm+RN1WtevrMD/p7lGqhdJADzIFO/aRO+VLMqMO8OfhSSRU/3hqP/aBnafeKBPRup5WdRrEtbcu5UvRuwKV8nNnCnS9ENcfnXSjTJ2TjPu203d/KStkDxwFPrK2qb1RJg3SB558kvFE33WEDs+rVDDTQPeFqkrrUr66JxlPdI3shJpjJ2/jeqNMWhbEpVNSFc/vF++nKiaVV3KvJKW1DhOgVEumge5pxjifUlJPy7r29eGyOhu53CjTri/0uPbUfuyIuFNONmYAD2Xs4Z5pK7h9aj6zc3NIidUrSJRqqdzqQxeR4cCfATswxRjz3GnWuwmYB2QbY87YQR6wfegn3ShTT5fI/lLnSH2uQiLrv6PxxLzYcyAkrNElrdiyh9Fvr3A+hHpCDsmx4U38kEopf9Wkk6IiYgc2ApcBpUAecLsxZn2d9WKBfwJhwMSADHTXG2XqDu504t/6bpSJTjn9dddx6RCV4PVL+ZaVVDDm7TzSEyKZNSGHpBgNdaWCUVNPig4Aio0xJdabzQFGAOvrrPf/gD8AjzahVu+qqXaOdV23Ze3aj3384MnbuN4o03lYnatD0v3mRpmcjESmjc5mzPQV3PnWcmZNGEiihrpSLYo7gZ4K7HCZLgUGuq4gIucD6caYf4rIaQNdRHKBXID27ds3vNqzOXawzi3odUboO7ALTM3J25y4USaxM2QMOfUux6ikgBk29YLOiUwblc2Y6XncOWU5sybkkBDd+K4cpVRgafJJURGxAS8Bo8+2rjHmTeBNcHa5NGqHe7bArlX1P6TglBtlQpwt6Lh06HhRPeOHpDrHvQ4iF3ZJYuqobMbNsEJ9/EDiNdSVahHcCfSdQLrLdJo174RY4FxgsTj7idsC80XkurP1ozfKhvnw2ZPO1xFx1k0x6dD+glPHv45p0yJvlLmoaxJv3ZPF+Jn5Vkt9IK2jNNSVCnbunBQNwXlSdBjOIM8D7jDGrDvN+ouBR7x2UvTgD3B0r94o44bFRWXkzlxJt7YxvDcuh7goHXJWqUB3ppOiZ+0cNsZUAxOBT4ENwPvGmHUi8oyIXOfZUt0Q2xZSemiYu2FIZgpv3N2fjT8c4q6py9l/tMrXJSmlvEjHcmkBFm74kfveXUnPdq14Z/xAWkVoS12pQNWkFroKfMN6tOG1O/uz/vsD3DN1BQcrtaWuVDDSQG8hLu3Zhsl3nM/anfsZNU1DXalgpIHeglzeqy2v3nE+35XuZ/TbeRw6Vn32jZRSAUMDvYUZfm5b/u/2fhTs2MeYt1dwWENdqaChgd4CXXleO14Z2Y9V2/cxZnoeR45rqCsVDDTQW6ire7fj5dv6kr91D2M11JUKChroLdi1fc7hT7f1ZcWWPYybns/R4zVn30gp5bc00Fu4EX1T+eOtfVi2pYLxM/OorNJQVypQaaArbuiXxos39+HrzRVMmJmvoa5UgNJAVwDc1D+N52/qzVfFu8l9Z6WGulIBSANd1bolK50/3NibJRvLue/dlRyr1lBXKpBooKuT3JqdznM3nsfionJ+/u4qDXWlAogGujrFyAHt+d8bzuOLwjIeeG8Vx6sdvi5JKeUGDXRVrzsGtmfS9efy+YYyHpiloa5UINBAV6d1V04HnhnRi8/W/8iDs1dRVaOhrpQ/00BXZ3TPBR156tqefLruR34x+1sNdaX8mAa6OqvRgzrx5DU9WbD2B345p4BqDXWl/JI7D4lWirEXdcJhDJP+uQERePm2voTYtT2glD/RQFduG39xBg5j+N9PCrGJ8NKtfTTUlfIjGuiqQXIv6YzDwHMLCrEJ/PHWvtht4uuylFJooKtGuG9wZ2ochhc+LcImwgu39NFQV8oPaKCrRnlgaBeMMbz4742ICM/f3FtDXSkf00BXjTbxZ12pccCfPt+ITeAPN/XGpqGulM9ooKsmeejSrjiM4c8LN2ET4dkbz9NQV8pHNNBVk/3SCvX/+6IYmw3+53oNdaV8QQNdNZmI8PBl3XAYw+RFm7GJMOn6cxHRUFeqOWmgK48QER65PJMaB7z+pTPUnxnRS0NdqWakga48RkT47fBMjDG8saQEm8BT12moK9VcNNCVR4kIj13ZnRqHYcpXW7DZhCev6amhrlQz0EBXHiciPH51DxwGpi3dgk2EJ67uoaGulJdpoCuvEBF+d00PHMYw9ast2AT++yoNdaW8ya2RlURkuIgUiUixiDxWz/L7RGSNiBSIyFci0tPzpapAIyL8/tqe3HNBB976zxae+1chxhhfl6VU0DprC11E7MBk4DKgFMgTkfnGmPUuq80yxrxurX8d8BIw3Av1qgAjIjx9XS8cxvDGlyXYRPjNFZnaUlfKC9zpchkAFBtjSgBEZA4wAqgNdGPMAZf1owFthqlaIsIz152Lw8BrizdjF+HXl3fTUFfKw9wJ9FRgh8t0KTCw7koi8gDwMBAG/Ky+NxKRXCAXoH379g2tVQUwm02YNOJcHA7Dq4uKsdmcNyMppTzHY08nMMZMNsZ0Bn4LPHGadd40xmQZY7KSk5M9tWsVIGw24X9vOI9bs9J4ZeEmXv58o69LUiqouNNC3wmku0ynWfNOZw7wWlOKUsHLZhOeu7E3DgMvf+4c0OsXw7r6uiylgoI7gZ4HdBWRTjiDfCRwh+sKItLVGLPJmrwa2IRSp2GzCX+4qTcOY3jps43YbcIDQ7v4uiylAt5ZA90YUy0iE4FPATswzRizTkSeAfKNMfOBiSJyKVAF7AVGebNoFfjsNuGFm/tgDLzwaREicP8QDXWlmsKtG4uMMZ8An9SZ96TL64c8XJdqAew24cVb+uAwhuf/VYRdhHsHd/Z1WUoFLL1TVPmU3Sb88ZY+OAw8u6AQmwgTLsnwdVlKBSQNdOVzIXYbf7q1Dw6H4X8+2YAIjL9YQ12phtJAV34hxG7j5ZF9cRjDpH9uwG4Txgzq5OuylAooHrsOXammCrXbeOX2flzRqw1P/309M77e6uuSlAooGujKr4Tabfzf7edzWc82/H7+Ot75ZquvS1IqYGigK78TFmJj8h3nc2mPFH738TreXbbN1yUpFRA00JVfCguxMfnO8/lZ9xSe+NtaZi3f7uuSlPJ7GujKb4WH2HntrvMZmpnMf3+0hrl5GupKnYkGuvJrzlDvz+BuyTz24Rrez99x9o2UaqE00JXfiwi188bd/bmoSxK//eA75q0s9XVJSvklDXQVECJC7bx1TxaDOifx6LzVfLhKQ12pujTQVcA4EeoXZCTyyF9X87dvzzSKs1Itjwa6CiiRYXamjspmQKcEHn6/gI8LNNSVOkEDXQWcyDA700Znk9UxgV/NLeDvq3f5uiSl/IIGugpIUWEhvD06m6wOCfxybgH//O57X5eklM9poKuAFR0ewrQx2fRLb80v5nzLgjUa6qpl00BXAS0mPITpYwfQJy2OB2d/y7/W/uDrkpTyGQ10FfBiwkOYMXYA56XFMXHWKv69TkNdtUwa6CooxEaEMmPsAHqlxvHArFV8vv5HX5ekVLPTQFdBo1VEKDPHDqBHu1bc/94qvijUUFctiwa6CipxkaG8M3Yg3drGcN87q1hUVObrkpRqNhroKujERYXy7riBdG0Tw73vrOTLjeW+LkmpZqGBroJS66gw3h03kM7JMUyYmc9/Nmmoq+Cnga6CVnx0GO+NH0hGUjTjZ+SztHi3r0tSyqs00FVQS4gOY9aEHDolRTNuRh5fa6irIKaBroJegtVSb58QxdgZeXyzucLXJSnlFRroqkVIjAln1oQc0uOjGDs9j+UlGuoq+GigqxYjyQr1c1pHMGZ6Hnlb9/i6JKU8SgNdtSjJseHMnpBD27gIRk9bQb6GugoiGuiqxUlpFcHsCTmktIpg1LQVrNy219clKeURGuiqRWpjhXpybDijpq1g1XYNdRX43Ap0ERkuIkUiUiwij9Wz/GERWS8i34nIQhHp4PlSlfKstnERzM7NITEmjFFTV1CwY5+vS1KqSc4a6CJiByYDVwI9gdtFpGed1b4FsowxvYF5wPOeLlQpb2gXF8nsCTnER4dx99TlfFeqoa4Clzst9AFAsTGmxBhzHJgDjHBdwRizyBhzxJpcBqR5tkylvOec1pHMzs0hLjKUu6YsZ+3O/b4uSalGcSfQU4EdLtOl1rzTGQcsqG+BiOSKSL6I5JeX69gayn+ktna21GMjQrn9rWU8NX8di4vKqKyq8XVpSrktxJNvJiJ3AVnA4PqWG2PeBN4EyMrKMp7ct1JNlZ4QxZzcHJ7++zrm5G1n+tdbiQi1cWHnJIZmJjMkM5ZhSeUAAA4ESURBVIX0hChfl6nUabkT6DuBdJfpNGveSUTkUuBxYLAx5phnylOqeaUnRDFlVDaVVTUsK6lgcVE5XxSW8UVhGbCOLikxDM1MZmhmClkdEwgL0QvFlP8QY87cUBaREGAjMAxnkOcBdxhj1rms0w/nydDhxphN7uw4KyvL5OfnN7ZupZqNMYYtuw+zqKicxUVlLC/Zw/EaB9Fhdi7qmsTQzBSGZKbQNi7C16WqFkBEVhpjsupbdtYWujGmWkQmAp8CdmCaMWadiDwD5Btj5gMvADHAX0UEYLsx5jqPfQKlfEhEyEiOISM5hnEXdeLwsWq+3lzBoqIyFheW8ek656PuerRr5Wy9d0+hX3prQuzaelfN66wtdG/RFroKBsYYNv54iEVFZSwqLCN/215qHIa4yFAutlrvgzOTSYoJ93WpKkicqYWuga6UB+0/WsXS4t0sKixjUVE5uw8dQwR6p8YxJDOFn3VP4bzUOGw28XWpKkBpoCvlAw6HYf33B6xwL+PbHfswBhKjwxhsnVi9pGsycVGhvi5VBRANdKX8wJ7Dx/nPpnIWFZbx5cZy9h6pwibQv0M8QzJTGJqZQo92sVjnoZSqlwa6Un6mxmFYXbqPxVbXzBrr7tQ2rcJrr5oZ1CWR2AhtvauTaaAr5efKDlbyZVE5i4vKWbKxnIPHqgm1C9kdExiamcLQ7sl0To7R1rvSQFcqkFTVOFi5bS+LreveC384CEBafGRtuF+QkURkmN3HlSpf0EBXKoDt2nfUuiyynKXFuzlaVUNYiI0LMhJrr3vvkBjt6zJVM9FAVypIHKuuYcWWPSwqdLbeS3YfBiAjKdp5YrV7MgM6JRAeoq33YKWBrlSQ2rr7MIuLnCdWvymp4Hi1g8hQO4O6JDG0u3NAsdTWkb4uU3mQBrpSLcDR4zV8U7KbRYXOAcV27jsKQGabWIZ0d1733r9DPKE6JEFA00BXqoUxxrC5/BCLCstZVFRG3tY9VNUYYsNDuLhbEkMyUxjSLZmUVjqgWKDRQFeqhTtYWcXS4gqre6aMHw84R7g+N7VV7XXvfdNbY9chCfyeBrpSqpYxhg3fH3SOFllUxspte3EYaB0VyuBu1pAE3ZJJiA7zdamqHhroSqnT2n+kiiWbnF0zXxaVU3H4OCLQN72187r3zBR6ndNKBxTzExroSim3OByGNTv3O697Lyrnu1LngGJJMeEMsQYUu6hrEnGROiSBr2igK6UaZfehYyzZWM4ia0iC/UersNuE/h3ia+9azWyjA4o1Jw10pVSTVdc4KNixr/au1fXfHwCgXVyENVpkMoO6JBEd7tFnz6s6NNCVUh73w/5KvtzoDPevindz6Fg1YXYbAzolOLtnuqeQkRStrXcP00BXSnnV8WoH+dv2sLjIOd77prJDALRPiGJoZjJDuqdwQUYiEaE6JEFTaaArpZrVjj1HWLyxnMWFZSzdvJvKKgfhITYu7JzI0O7OK2fSE6J8XWZA0kBXSvlMZVUNy7fsqX0U37aKIwB0To5mqPWc1ayOCYSF6JAE7tBAV0r5jS27D9eG+/KSPRyvcRAdZueirkm1d622jdMhCU5HA10p5ZcOH6vmm80V1pUzZezaXwlA97ax/Kx7CkO7p9AvvTUhOqBYLQ10pZTfM8awqexQbes9f+teqh2GVhEhXGINSTA4M5mkmHBfl+pTGuhKqYBzoLKKpZt21961Wn7QOaBYn7Q462EeKfROjWtxQxJooCulAprDYVj//YHah3l8u905oFhidBiDuzkvi7ykaxKto4J/QDENdKVUUNl7+LhzQLHCMr7cWM7eI1XYBM5vH8/Q7ikMyUymZ7tWQXlTkwa6Uipo1TgMq0v3sbjQ2Xpfs3M/ACmx4bXjzQzqkkRsRHAMKKaBrpRqMcoOVvJlUTmLi8pZsqmcg5XVhNiE7I4JDLUexdclJSZgW+8a6EqpFqmqxsGqbXtZVFTO4qIyCn84CEBq68jacL+gcyJRYYEzoJgGulJKAbv2HXWON1NUxtLi3Rw5XkNYiI2cjESGWuO9d0yK9nWZZ9TkQBeR4cCfATswxRjzXJ3llwAvA72BkcaYeWd7Tw10pZQvHauuIW/LXuuyyDJKyg8D0CkpuvZhHgM6JfjdgGJNCnQRsQMbgcuAUiAPuN0Ys95lnY5AK+ARYL4GulIq0GyrOFzbev9mcwXHqh1EhtoZ1CWRIZnOK2fS4n0/oNiZAt2djqMBQLExpsR6sznACKA20I0xW61ljiZXq5RSPtAhMZpRF0Yz6sKOHD1ew7IS55AEXxSW8fmGMgC6tYmpHW8mq2M8oX42JIE7gZ4K7HCZLgUGNmZnIpIL5AK0b9++MW+hlFJeFxlmdw7z2z2Fp68zbC4/bN3UVMa0pVt4Y0kJseEhLgOKJZPSyvcDijXrqV1jzJvAm+DscmnOfSulVGOICF1SYuiSEsP4izM4dKyapcW7nQFfWM6CtT8A0OucVrXXvfdNj8fugyEJ3An0nUC6y3SaNU8ppVqcmPAQrujVlit6tcUYQ+EPB1lUVMbiwnJe+3Izry4qpnVUKJd0TWZo92Qu6ZpMYjMNKOZOoOcBXUWkE84gHwnc4dWqlFIqAIgIPdq1oke7Vtw/pAv7j1Txn+JyFhWW8+XGMuav3oUI9ElrXdt6P/cc7w0o5u5li1fhvCzRDkwzxvyPiDwD5Btj5otINvAREA9UAj8YY3qd6T31KhelVDBzOAxrd+1nUaHzypnVpfswBpJiwvjdNT0Z0Te1Ue+rNxYppZSPVRw6Zg0oVs6dA9szMCOxUe/T1MsWlVJKNVFiTDg39Evjhn5pXtuHf11EqZRSqtE00JVSKkhooCulVJDQQFdKqSChga6UUkFCA10ppYKEBrpSSgUJDXSllAoSPrtTVETKgW2N3DwJ2O3BcjxF62oYravh/LU2rathmlJXB2NMcn0LfBboTSEi+ae79dWXtK6G0boazl9r07oaxlt1aZeLUkoFCQ10pZQKEoEa6G/6uoDT0LoaRutqOH+tTetqGK/UFZB96EoppU4VqC10pZRSdWigK6VUkPC7QBeR4SJSJCLFIvJYPcvDRWSutXy5iHR0WfZf1vwiEbmimet6WETWi8h3IrJQRDq4LKsRkQLrZ34z1zVaRMpd9j/eZdkoEdlk/Yxq5rr+5FLTRhHZ57LMm8drmoiUicja0ywXEXnFqvs7ETnfZZlXjpcbNd1p1bJGRL4WkT4uy7Za8wtExOOPAHOjtiEist/l9/Wky7Izfge8XNejLjWttb5TCdYyrxwzEUkXkUVWDqwTkYfqWce73y9jjN/84Hxm6WYgAwgDVgM966xzP/C69XokMNd63dNaPxzoZL2PvRnrGgpEWa9/fqIua/qQD4/XaODVerZNAEqsf+Ot1/HNVVed9R/E+axarx4v670vAc4H1p5m+VXAAkCAHGB5Mxyvs9V04Yl9AVeeqMma3gok+fB4DQH+0dTvgKfrqrPutcAX3j5mQDvgfOt1LLCxnv8evfr98rcW+gCg2BhTYow5DswBRtRZZwQww3o9DxgmImLNn2OMOWaM2QIUW+/XLHUZYxYZY45Yk8sA7z1nqgF1ncEVwGfGmD3GmL3AZ8BwH9V1OzDbQ/s+I2PMEmDPGVYZAcw0TsuA1iLSDi8er7PVZIz52tonNN9368S+z3a8Tqcp301P19Us3y9jzPfGmFXW64PABqDuk6C9+v3yt0BPBXa4TJdy6gGpXccYUw3sBxLd3Nabdbkah/P/widEiEi+iCwTkes9VFND6rrJ+vNunoikN3Bbb9aF1TXVCfjCZba3jpc7Tle7N49XQ9T9bhng3yKyUkRyfVAPwAUislpEFohIL2ueXxwvEYnCGYwfuMz2+jETZ1dwP2B5nUVe/X7pQ6I9TETuArKAwS6zOxhjdopIBvCFiKwxxmxuppL+Dsw2xhwTkXtx/nXzs2batztGAvOMMTUu83x5vPyWiAzFGegXucy+yDpWKcBnIlJotV6byyqcv69DInIV8DegazPu/2yuBZYaY1xb8149ZiISg/N/IL80xhzw1Pu6w99a6DuBdJfpNGteveuISAgQB1S4ua0360JELgUeB64zxhw7Md8Ys9P6twRYjPP/3M1SlzGmwqWWKUB/d7f1Zl0uRlLnz2EvHi93nK52bx6vsxKR3jh/fyOMMRUn5rscqzLgIzzXzegWY8wBY8wh6/UnQKiIJOHj4+XiTN8vjx8zEQnFGebvGWM+rGcV736/PH1ioIknFUJwngzoxE8nUnrVWecBTj4p+r71uhcnnxQtwXMnRd2pqx/Ok0Bd68yPB8Kt10nAJjx0csjNutq5vL4BWGZ+Ogmzxaov3nqd0Fx1Wet1x3mCSprjeLnsoyOnP8l3NSeftFrh7ePlRk3tcZ4TurDO/Ggg1uX118BwTx4rN2pre+L3hzMYt1vHzq3vgLfqspbH4exnj26OY2Z97pnAy2dYx6vfL4/+4j10UK7CeXZ4M/C4Ne8ZnK1egAjgr9YXfAWQ4bLt49Z2RcCVzVzX58CPQIH1M9+afyGwxvpCrwHGNXNdzwLrrP0vArq7bDvWOo7FwJjmrMuafgp4rs523j5es4HvgSqc/ZTjgPuA+6zlAky26l4DZHn7eLlR0xRgr8t3K9+an2Edp9XW7/hxTx4rN2ub6PL9WobL/3Tq+w40V13WOqNxXijhup3XjhnOrjADfOfyu7qqOb9feuu/UkoFCX/rQ1dKKdVIGuhKKRUkNNCVUipIaKArpVSQ0EBXSqkgoYGulFJBQgNdKaWCxP8H9xmAoXO/RrAAAAAASUVORK5CYII=\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"code","source":["# Prediction on test set\n","\n","#print('Predicting labels for {:,} test sentences...'.format(len(prediction_inputs)))\n","\n","# Put model in evaluation mode\n","model.eval()\n","\n","# Tracking variables \n","predictions , true_labels = [], []\n","\n","test_acc = 0.0\n","test_f1 = 0.0\n","\n","# Predict \n","for batch in prediction_dataloader:\n","  # Add batch to GPU\n","  batch = tuple(t.to(device) for t in batch)\n","  \n","  # Unpack the inputs from our dataloader\n","  b_input_ids, b_input_mask, b_labels = batch\n","  \n","  # Telling the model not to compute or store gradients, saving memory and \n","  # speeding up prediction\n","  with torch.no_grad():\n","      # Forward pass, calculate logit predictions\n","      outputs = model(b_input_ids, token_type_ids=None, \n","                      attention_mask=b_input_mask)\n","\n","  logits = outputs[0]\n","\n","  # Move logits and labels to CPU\n","  logits = logits.detach().cpu().numpy()\n","  label_ids = b_labels.to('cpu').numpy()\n","  \n","  # Store predictions and true labelstest\n","  predictions.append(logits)\n","  true_labels.append(label_ids)"],"metadata":{"id":"iFkczbPyr98O","executionInfo":{"status":"ok","timestamp":1651379737207,"user_tz":-420,"elapsed":26560,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":29,"outputs":[]},{"cell_type":"code","source":["# Combine the predictions for each batch into a single list of 0s and 1s.\n","flat_predictions = [item for sublist in predictions for item in sublist]\n","flat_predictions = np.argmax(flat_predictions, axis=1).flatten()"],"metadata":{"id":"j4N6ykXqr_29","executionInfo":{"status":"ok","timestamp":1651379737208,"user_tz":-420,"elapsed":22,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":30,"outputs":[]},{"cell_type":"code","source":["flat_true_labels = [item for sublist in true_labels for item in sublist]"],"metadata":{"id":"bOcmHIobsCGd","executionInfo":{"status":"ok","timestamp":1651379737209,"user_tz":-420,"elapsed":21,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}}},"execution_count":31,"outputs":[]},{"cell_type":"code","source":["from sklearn.metrics import confusion_matrix, classification_report, f1_score\n","\n","print(classification_report(flat_predictions, flat_true_labels))"],"metadata":{"id":"EXim_iiIsD2V","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1651379737210,"user_tz":-420,"elapsed":21,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"b967f1ac-2bf3-4ef0-d13f-eb0cdc8a8f08"},"execution_count":32,"outputs":[{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","           0       0.85      0.88      0.86       167\n","           1       0.95      0.90      0.92       214\n","           2       0.91      0.95      0.93       106\n","           3       0.86      0.89      0.87       117\n","           4       0.91      0.90      0.91       188\n","\n","    accuracy                           0.90       792\n","   macro avg       0.90      0.90      0.90       792\n","weighted avg       0.90      0.90      0.90       792\n","\n"]}]},{"cell_type":"code","source":["import seaborn as sns\n","\n","cf_matrix = confusion_matrix(flat_predictions, flat_true_labels)\n","plt.figure()\n","sns.heatmap(cf_matrix, annot=True, fmt='d')"],"metadata":{"id":"eCSFfQSWsHs5","colab":{"base_uri":"https://localhost:8080/","height":282},"executionInfo":{"status":"ok","timestamp":1651379737945,"user_tz":-420,"elapsed":748,"user":{"displayName":"vito rihaldijiran","userId":"11435483051349741007"}},"outputId":"b4e74d0d-7d58-4b01-fd80-84bb89a771a0"},"execution_count":33,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<matplotlib.axes._subplots.AxesSubplot at 0x7f53cdbb4ed0>"]},"metadata":{},"execution_count":33},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 2 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]}]}